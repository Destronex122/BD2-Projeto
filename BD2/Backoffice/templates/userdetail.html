{% extends 'base.html' %}

{% block title %}Perfil do Utilizador{% endblock %}

{% block content %}

{% load static %}

<div class="container mt-5">
    <div class="card shadow-lg p-4" style="max-width: 800px; margin: auto;">
        <div class="row">
            <!-- Coluna para a imagem do perfil -->
            <div class="col-md-4 text-center">
                <img src="{% static 'userIcon.png' %}" alt="Imagem do perfil" class="img-fluid rounded-circle mb-3" style="width: 150px; height: 150px;">
                <h3 id="nome" contenteditable="false" class="editable">João Silva</h3>
                <p id="email" class="text-muted editable" contenteditable="false">joao.silva@example.com</p>
            </div>
            
            <!-- Coluna para as informações do perfil -->
            <div class="col-md-8">
                <div style="display:flex; justify-content: space-between;">
                    <h4 style="color:#616646; margin-left:14px;" class="mb-4">Informações do Perfil</h4>
                    {% if is_admin %}
                    <div style="justify-self:right; text-align:center;">
                        <button class="button" id="editar-btn">
                            <img src="{% static 'edit.png' %}" alt="add" style="height: 25px; width: auto;">
                        </button>
                    </div>
                    {% endif %}
                </div>
                
                <ul class="list-group list-group-flush">
                    <li class="list-group-item"><strong>Nome:</strong> <span id="nome-list" contenteditable="false" class="editable">João Silva</span></li>
                    <li class="list-group-item"><strong>Email:</strong> <span id="email-list" contenteditable="false" class="editable">joao.silva@example.com</span></li>
                    <li class="list-group-item"><strong>Telefone:</strong> <span id="telefone" contenteditable="false" class="editable">+351 912 345 678</span></li>
                    <li class="list-group-item"><strong>Endereço:</strong> <span id="endereco" contenteditable="false" class="editable">Rua das Flores, 123, Lisboa</span></li>
                    <li class="list-group-item"><strong>Descrição:</strong> <span id="descricao" contenteditable="false" class="editable">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus lacinia odio vitae vestibulum vestibulum.</span></li>
                </ul>
                <div style="display:flex; justify-content: flex-end;">
                    {% if is_admin %}
                    <div style="justify-self:right; text-align:center; margin-top: 16px;">
                        <button class="secondary-button" id="cancelar-btn" style="display: none;">Cancelar</button>
                        <button class="button" id="salvar-btn" style="display: none;">Guardar</button>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    const editarBtn = document.getElementById('editar-btn');
    const salvarBtn = document.getElementById('salvar-btn');
    const cancelarBtn = document.getElementById('cancelar-btn');
    const editables = document.querySelectorAll('.editable');

    // Função para ativar a edição
    editarBtn.addEventListener('click', () => {
        editables.forEach(el => el.contentEditable = "true");
        editarBtn.style.display = 'none';
        salvarBtn.style.display = 'inline-block';
        cancelarBtn.style.display = 'inline-block';
    });

    // Função para salvar alterações
    salvarBtn.addEventListener('click', () => {
        editables.forEach(el => el.contentEditable = "false");
        editarBtn.style.display = 'inline-block';
        salvarBtn.style.display = 'none';
        cancelarBtn.style.display = 'none';

        // Atualizar valores nos dois lugares (caso existam duplicados)
        document.getElementById('nome-list').textContent = document.getElementById('nome').textContent;
        document.getElementById('email-list').textContent = document.getElementById('email').textContent;
    });

    // Função para cancelar edição
    cancelarBtn.addEventListener('click', () => {
        editables.forEach(el => el.contentEditable = "false");
        editarBtn.style.display = 'inline-block';
        salvarBtn.style.display = 'none';
        cancelarBtn.style.display = 'none';
    });
</script>

<style>
    .container {
        padding: 20px;
    }
    
    .card {
        border-radius: 10px;
        border: none;
    }
    
    .list-group-item {
        border: none;
        padding: 10px 15px;
    }
    
    h4 {
        font-weight: bold;
    }

    .editable[contenteditable="true"] {
        border: 1px dashed #ccc;
        padding: 2px;
        border-radius: 5px;
    }
</style>

{% endblock %}
